{% extends 'site_base.html' %}
{% block content %}
  <h1>Select a book</h1>

  {% if results %}
    <p>Choose the correct book, or proceed with manual entry.</p>

    <form method="post">
      {% csrf_token %}

      {% for book in results %}
        <div class="book-result">
          <label>
            <input type="radio" name="choice" value="{{ forloop.counter0 }}" required />

            <strong>{{ book.title }}</strong>

            {% if book.authors %}
              <div>By {{ book.authors|join:', ' }}</div>
            {% endif %}

            {% if book.published_year %}
              <div>Published: {{ book.published_year }}</div>
            {% endif %}

            {% if book.page_count %}
              <div>Pages: {{ book.page_count }}</div>
            {% endif %}

            {% if book.thumbnail %}
              <div>
                <img src="{{ book.thumbnail }}" loading="lazy" alt="" />
              </div>
            {% endif %}

            {% if book.description %}
              <p>{{ book.description|truncatewords:40 }}</p>
            {% endif %}
          </label>
        </div>
      {% endfor %}

      <hr />

      <div class="book-result">
        <label>
          <input type="radio" name="choice" value="manual" />
          <strong>Enter details manually</strong>
        </label>
      </div>

      <button type="submit">Continue</button>
    </form>
  {% endif %}
{% endblock %}
