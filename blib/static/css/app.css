@layer global, component, utility;

@layer global {
  /* Fonts */
  /* Open Sans 300-800*/
  @font-face {
    font-family: 'Open Sans';
    font-style: normal;
    font-weight: 300 800;
    font-stretch: 100%;
    font-display: swap;
    src: url('../fonts/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-mu0SC55I.woff2')
      format('woff2');
    unicode-range:
      U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA,
      U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122,
      U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
  }
  @font-face {
    font-family: 'Open Sans';
    font-style: italic;
    font-weight: 300 800;
    font-stretch: 100%;
    font-display: swap;
    src: url('../fonts/memtYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWqWuU6FxZCJgg.woff2')
      format('woff2');
    unicode-range:
      U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA,
      U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122,
      U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
  }
  /* Lora 400-700 */
  @font-face {
    font-family: 'Lora';
    font-style: normal;
    font-weight: 400 700;
    font-display: swap;
    src: url('../fonts/0QIvMX1D_JOuMwr7I_FMl_E.woff2') format('woff2');
    unicode-range:
      U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA,
      U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122,
      U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
  }
  @font-face {
    font-family: 'Lora';
    font-style: italic;
    font-weight: 400 700;
    font-display: swap;
    src: url('../fonts/0QIhMX1D_JOuMw_LIftLtfOm8w.woff2')
      format('woff2');
    unicode-range:
      U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA,
      U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122,
      U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
  }
  /* Font family and sizes */
  :root {
    --font-headings: 'Lora', Georgia, Times, 'Times New Roman', serif;
    --font-text: 'Open Sans', Arial, Helvetica, sans-serif;

    --fs-14: calc(14 / 16 * 1rem);
    --fs-16: calc(16 / 16 * 1rem);
    --fs-18: calc(18 / 16 * 1rem);
    --fs-20: calc(20 / 16 * 1rem);
    --fs-22: calc(22 / 16 * 1rem);
    --fs-24: calc(24 / 16 * 1rem);
    --fs-28: calc(28 / 16 * 1rem);
    --fs-30: calc(30 / 16 * 1rem);
    --fs-32: calc(32 / 16 * 1rem);
    --fs-34: calc(34 / 16 * 1rem);
    --fs-36: calc(36 / 16 * 1rem);
    --fs-38: calc(38 / 16 * 1rem);
    --fs-40: calc(40 / 16 * 1rem);
    --fs-42: calc(42 / 16 * 1rem);
    --fs-48: calc(48 / 16 * 1rem);
    --fs-56: calc(56 / 16 * 1rem);
    --fs-72: calc(72 / 16 * 1rem);

    --font-size-topnav: var(--fs-20);
    /* --font-size-h1: var(--fs-42); */
    --font-size-h1: var(--fs-36);
    /* --font-size-h2: var(--fs-36); */
    --font-size-h2: var(--fs-30);
    --font-size-h3: var(--fs-24);
    --font-size-button: var(--fs-18);
    --font-size-quote: var(--fs-24);
    --font-size-book-title: var(--fs-20);
    --font-size-book-author: var(--fs-16);
    --font-size-form-label: var(--fs-20);
    --font-size-form: var(--fs-18);
    --font-size-search-heading: var(--fs-36);
    --font-size-book-card-heading: var(--fs-22);

    @media (width >= calc(600 / 16 * 1rem)) {
      --font-size-topnav: var(--fs-20);
      /* --font-size-h1: var(--fs-72); */
      --font-size-h1: var(--fs-56);
      /* --font-size-h2: var(--fs-48); */
      --font-size-h2: var(--fs-40);
      /* --font-size-quote: var(--fs-36); */
      --font-size-quote: var(--fs-32);
      /* --font-size-book-title: var(--fs-24);
      --font-size-book-author: var(--fs-18); */
      --font-size-form-label: var(--fs-24);
      --font-size-search-heading: var(--fs-48);
      --font-size-book-card-heading: var(--fs-24);
    }
  }

  /* Colors */
  /*
  Two sets of color custom properties -
  one for the actual color,
  then one for where they'll actually be used
*/
  :root {
    --hue-primary: 230;
    --hue-secondary: 180;
    --hue-beige: 40;

    --c-white: hsl(0, 0%, 96%);
    --c-white-bone: hsl(0, 10%, 90%);
    --c-white-dark: hsl(0, 0%, 91%);
    --c-gray-dark: hsl(233, 14%, 25%);
    --c-gray-dark-40: hsl(233, 14%, 25%, 38%);
    --c-gray-medium: hsl(233, 14%, 45%);
    --c-gray-medium-light: hsl(233, 14%, 55%);
    --c-gray-light: hsl(229, 14%, 85%);
    --c-gray-lighter: hsl(233, 14%, 90%);
    --c-purple: hsl(232, 58%, 55%);
    /* --c-purple: green; */
    --c-purple-60: hsl(232, 58%, 35%, 60%);
    --c-purple-light: hsl(232, 58%, 65%);
    --c-purple-light-pastel: hsl(232, 25%, 88%);
    --c-teal: hsl(180, 100%, 42%);
    --c-teal-dark: hsl(180, 100%, 37%);
    --c-transparent: transparent;
    --c-magenta: hsl(320, 85%, 41%);

    --color-main-bg: hsl(var(--hue-primary), 5%, 96%);
    /* --color-main-bg: var(--c-white); */
    --color-text-dark: var(--c-gray-dark);
    --color-text-light: var(--c-white);
    --color-text-muted: var(--c-gray-medium);

    --color-header-bg: var(--c-purple);
    --color-topnav-menu-bg: var(--c-purple);
    --color-topnav-menu-overlay: var(--c-gray-dark-40);
    --color-topnav-menu-shadow: var(--c-purple-60);
    --color-hero-bg: var(--c-purple);
    --color-fullwidth-bg: var(--c-magenta);
    --color-cta-gradient1: var(--c-gray-dark);
    --color-cta-gradient2: var(--c-purple);
    --color-cta-gradient3: var(--c-teal);
    --color-footer-link-hover: var(--c-magenta);

    --color-button-primary-bg: var(--c-teal);
    --color-button-primary-bg-hover: var(--c-teal-dark);
    --color-button-primary-text: var(--c-gray-dark);
    --color-button-secondary-bg: var(--c-transparent);
    --color-button-secondary-border: var(--c-gray-dark);
    --color-button-secondary-text: var(--c-gray-dark);
    --color-button-secondary-bg-hover: var(--c-teal);
    --color-button-secondary-border-hover: var(--c-transparent);
    --color-button-tertiary-bg: var(--c-white);
    --color-button-tertiary-bg-hover: var(--c-teal);
    --color-button-tertiary-text: var(--c-gray-dark);

    --color-sticky-search-bg: var(--c-purple-light-pastel);
    --color-sticky-search-autocomplete-hover-bg: var(
      --c-purple-light
    );
    --color-sticky-search-autocomplete-hover-text: var(--c-white);
    /* --backdrop-filter-sticky-search: blur(12px) saturate(1.2); */
    /* --color-sticky-search-focus-ring: hsl(232, 60%, 30%); */
    --color-sticky-search-focus-ring: AccentColor;
    --color-form-input-bg: var(--c-white);
    --color-clear-button-hover: var(--c-magenta);

    --color-book-card-author-hover: var(--c-magenta);
    --color-search-results-divider: var(--c-gray-light);

    --color-collections-border: var(--c-gray-light);
    --color-collections-border-hover: var(--c-gray-lighter);

    --shadow-gray: 0 8px 24px hsl(0 0% 0% / 0.08);
  }

  /* Spacing */
  :root {
    --vertical-padding: 16px;
    --header-height: 54px;
    --thumbnail-cover-width: 100px;

    @media (width >= calc(600 / 16 * 1rem)) {
      --vertical-padding: 24px;
      --header-height: 82px;
    }

    @media (width >= calc(1000 / 16 * 1rem)) {
      --vertical-padding: 32px;
    }
  }

  /* Other stuff */
  :root {
    --cta-stop-two: 75%;
    --cta-stop-three: 150%;
    /* https://codepen.io/sosuke/pen/Pjoqqp */
    /* --filter-svg-magenta: invert(17%) sepia(64%) saturate(6506%)
      hue-rotate(309deg) brightness(80%) contrast(95%); */

    @media (width >= calc(600 / 16 * 1rem)) {
      --cta-stop-two: 60%;
      --cta-stop-three: 120%;
    }
  }

  html {
    scrollbar-gutter: stable;
  }

  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  * {
    margin: 0;
  }

  body {
    font-family: var(--font-text);
    line-height: 1.3;
    color: var(--color-text-dark);
    background-color: var(--color-main-bg);
  }

  h1,
  h2,
  h3 {
    font-family: var(--font-headings);
    line-height: 1.1;
  }

  h1,
  h2,
  h3,
  p {
    text-wrap: balance;
  }

  h1 {
    font-size: var(--font-size-h1);
  }

  h2 {
    font-size: var(--font-size-h2);
  }

  h3 {
    font-size: var(--font-size-h3);
  }

  p {
    font-size: var(--fs-18);

    &.small {
      font-size: var(--fs-16);
    }

    &.medium {
      font-size: var(--fs-20);

      @media (width >= calc(600 / 16 * 1rem)) {
        font-size: var(--fs-24);
      }
    }

    &.large {
      font-size: var(--fs-24);

      @media (width >= calc(600 / 16 * 1rem)) {
        font-size: var(--fs-28);
      }
    }
  }

  a {
    text-decoration: none;
    color: inherit;
  }

  img,
  picture,
  svg {
    max-width: 100%;
    display: block;
    height: auto;
  }

  input,
  button,
  textarea,
  select {
    font: inherit;
    border: none;
    padding: 0;
    background: none;
  }

  header ul,
  footer ul {
    list-style-type: none;
    padding: 0;
  }

  .wrapper {
    width: min(
      calc(100% - (2 * var(--vertical-padding))),
      calc(1200 / 16 * 1rem)
    );
    margin-inline: auto;
    padding-block: 60px;
  }

  .fullwidth {
    text-align: center;

    .fullwidth__wrapper {
      display: grid;
      justify-items: center;
    }

    .fullwidth__title {
      margin-block-end: 20px;
    }

    .fullwidth__text {
      max-width: 80ch;

      &:last-of-type {
        margin-block-end: 40px;
      }
    }
  }

  .clickable-parent {
    position: relative;
    isolation: isolate;

    /* Add focus around parent */
    &:focus-within {
      outline: 3px solid AccentColor;
      outline: 3px solid -webkit-focus-ring-color;
      outline-offset: 3px;

      /* Remove focus around child */
      :focus {
        outline: none;
      }
    }

    .clickable-parent-link::after {
      content: '';
      position: absolute;
      inset: 0;
      z-index: 1;
    }
  }

  .tap-target {
    position: relative;

    &::after {
      --min: 44px;
      content: '';
      position: absolute;
      inset: min(0px, calc((100% - var(--min)) / 2));
      pointer-events: auto;
    }
  }

  .icon {
    width: calc(24 / 16 * 1rem);
    height: calc(24 / 16 * 1rem);
    fill: none;
    stroke: currentColor;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
    flex-shrink: 0; /* To avoid getting shrunk in flex container */
  }

  .divider-above {
    padding-block-start: 32px;
    border-block-start: 2px solid var(--c-gray-lighter);
    margin-block-start: 32px;
  }
  .divider-below {
    padding-block-end: 32px;
    border-block-end: 2px solid var(--c-gray-lighter);
    margin-block-end: 32px;
  }

  .narrow-container {
    width: min(72ch, 100%);
    margin-inline: auto;
  }

  .absolute-inset-0 {
    position: absolute;
    inset: 0;
  }

  .text-muted {
    color: var(--c-gray-medium-light);
  }

  #app {
    display: grid;
    grid-template-rows: auto 1fr auto;
    min-height: 100vh; /* fallback */
    min-height: 100dvh;
    isolation: isolate;
  }

  /* Grid items have min-width: auto by default. Not good for wanting to have stuff overflow */
  #app > * {
    min-width: 0;
  }

  #padding {
    height: 50dvh;
  }
}

@layer component {
  .ui-backdrop {
    position: fixed;
    inset: 0;
    background-color: hsl(0, 0%, 0%, 0.75);
    opacity: 0;
    transition: opacity 250ms ease-in-out;
    z-index: 100;

    &.is-visible {
      opacity: 1;
      pointer-events: all;
    }

    &[hidden] {
      display: block;
      pointer-events: none;
      opacity: 0;
    }
  }

  .button {
    /* display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5ch; */
    display: inline-block;
    cursor: pointer;

    font-size: var(--font-size-button);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: 700;
    line-height: 1;

    border-radius: 100vmax;
    padding: 12px 20px;

    border: 2px solid transparent;
    background: none;
    color: inherit;

    transition: 150ms ease;
    transition-property: background-color, color, border-color;

    &:focus-visible {
      outline: 3px solid AccentColor;
      outline: 3px solid -webkit-focus-ring-color;
      outline-offset: 3px;
    }

    &.primary {
      background-color: var(--color-button-primary-bg);
      color: var(--color-button-primary-text);

      &:not(:disabled):hover {
        background-color: var(--color-button-primary-bg-hover);
      }
    }

    &.secondary {
      /* background-color: var(--color-button-secondary-bg); */
      color: var(--c-gray-dark);
      border-color: var(--c-gray-dark);

      &:not(:disabled):hover {
        background-color: var(--c-gray-lighter);
        /* color: var(--color-button-secondary-text-hover); */
        /* border-color: var(--color-button-secondary-border-hover); */
      }
    }

    &.tertiary {
      background-color: var(--color-button-tertiary-bg);
      color: var(--color-button-tertiary-text);

      &:not(:disabled):hover {
        background-color: var(--color-button-tertiary-bg-hover);
      }
    }
  }

  .topnav {
    position: sticky;
    top: 0;
    z-index: 100;
    background-color: var(--color-header-bg);
    height: var(--header-height);
    display: grid;
    align-content: center;

    .topnav__wrapper {
      display: grid;
      grid-template-columns: auto 1fr auto auto;
      grid-template-areas: 'logo . actions nav';

      padding-block: 0;

      @media (width >= calc(768 / 16 * 1rem)) {
        grid-template-columns: 1fr auto 1fr;
        grid-template-areas: 'logo nav actions';
      }
    }

    .topnav__homelink {
      grid-area: logo;
      justify-self: start;

      &:hover {
        opacity: 0.8;
      }
    }

    .topnav__logo {
      height: 30px;
      width: auto;

      @media (width >= calc(768 / 16 * 1rem)) {
        height: 40px;
      }
    }

    .topnav__nav {
      grid-area: nav;
      justify-self: center;
      align-self: center;
    }

    .topnav__desktop-nav-list {
      padding: 0;
      list-style: none;

      display: flex;
      flex-wrap: wrap;
      gap: 32px;
      color: var(--c-white);
      text-transform: uppercase;
      font-weight: 500;
      letter-spacing: 0.05em;
      font-size: calc(18 / 16 * 1rem);

      @media (width < calc(768 / 16 * 1rem)) {
        display: none;
      }
    }

    .topnav__desktop-nav-item {
      text-underline-offset: 3px;

      &:hover {
        text-decoration: 2px underline;
      }
    }

    .topnav__desktop-nav-link {
    }

    .topnav__open-btn {
      display: none;

      @media (width < calc(768 / 16 * 1rem)) {
        display: grid;
        place-content: center;
        cursor: pointer;
        margin-inline-start: 16px;

        position: relative;
        --click-target-minimum: 44px;
        --inset-by: min(
          0px,
          calc((100% - var(--click-target-minimum)) / 2)
        );

        &::after {
          content: '';
          position: absolute;
          top: var(--inset-by);
          left: var(--inset-by);
          right: var(--inset-by);
          bottom: var(--inset-by);
        }
      }
    }

    .topnav__open-icon {
      width: 32px;
      stroke: var(--c-white);
    }

    .topnav__search-btn {
      cursor: pointer;
      display: grid;
      place-content: center;
      position: relative;

      @media (width >= calc(768 / 16 * 1rem)) {
        &::after {
          content: '';
          position: absolute;
          bottom: -4px;
          left: 0;
          right: 0;
          height: 2px;
          background-color: var(--color-text-light);
          opacity: 0;
          transition: opacity 50ms ease-in-out;
        }

        &:hover::after {
          opacity: 1;
        }
      }
    }

    .topnav__account-link {
      position: relative;
      isolation: isolate;
      display: none;

      @media (width >= calc(768 / 16 * 1rem)) {
        display: block;
        &::after {
          content: '';
          position: absolute;
          bottom: -4px;
          left: 0;
          right: 0;
          height: 2px;
          background-color: var(--color-text-light);
          opacity: 0;
          transition: opacity 50ms ease-in-out;
        }

        &:hover::after {
          opacity: 1;
        }
      }
    }

    .topnav__account-icon-wrapper {
      display: grid;
      place-content: center;
    }

    .topnav__account-icon {
      fill: var(--color-text-light);
      stroke: var(--color-text-light);
      width: 28px;
    }

    .topnav__actions {
      grid-area: actions;
      justify-self: end;
      align-self: center;

      display: flex;
      gap: 16px;
    }

    .topnav__search-icon {
      width: 28px;
      color: var(--c-white);
    }
  }

  .footer {
    background-color: gainsboro;
    .footer__top-row {
      display: grid;
      gap: 12px;
      margin-block-end: 40px;
    }

    .footer__homelink {
      display: block;
      width: fit-content;

      &:hover {
        opacity: 0.8;
      }
    }

    .footer__logo {
      height: calc(30 / 16 * 1rem);
      width: auto;
      transform: translateX(-2px);
    }

    .footer__copyright {
      font-size: calc(16 / 16 * 1rem);
    }

    .footer__main-nav-area {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 40px 20px;
    }

    .footer__nav-item {
    }

    .footer__nav-title {
      font-size: calc(22 / 16 * 1rem);
      font-weight: 700;
      margin-block-end: 8px;
    }

    .footer__nav-list {
      display: grid;
      gap: 8px;
    }

    .footer__link {
      cursor: pointer;
      font-size: calc(16 / 16 * 1rem);
      transition: color 150ms ease-in-out;

      &:hover {
        color: var(--color-footer-link-hover);

        .footer__social-path {
          fill: var(--color-footer-link-hover);
        }
      }

      &.social {
        display: inline-flex;
        gap: 10px;
        align-items: center;
      }
    }

    .footer__social-svg {
      width: calc(18 / 16 * 1rem);
    }

    .footer__social-path {
      fill: var(--color-text-dark);
      transition: fill 150ms ease-in-out;
    }
  }

  .toast-stack {
    position: fixed;
    bottom: 20px;
    right: 20px;
    display: grid;
    gap: 10px;
    z-index: 300;

    .toast {
      background: #111;
      color: #fff;
      padding: 12px 16px;
      border-radius: 6px;
      min-width: 240px;
      max-width: 360px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      animation: toast-in 200ms ease-out forwards;
    }

    .toast--success {
      background: #2e7d32;
    }
    .toast--danger,
    .toast--error {
      background: #c62828;
    }
    .toast--warning {
      background: #ed6c02;
    }
    .toast--info {
      background: #0277bd;
    }

    @keyframes toast-in {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .toast.is-hiding {
      opacity: 0;
      transform: translateY(10px);
      transition: all 150ms ease-in;
    }

    .toast__close {
      cursor: pointer;
      margin-inline-start: 8px;
      height: 44px;
      width: 44px;
      display: grid;
      place-content: center;

      &:hover {
        opacity: 0.9;
      }
    }

    .toast__icon {
      color: #fff;
      pointer-events: none;
    }
  }
}

@layer utility {
  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    margin: -1px;
    border: 0;
    padding: 0;
    white-space: nowrap;
    clip-path: inset(100%);
    clip: rect(0 0 0 0);
    overflow: hidden;

    &.skip:focus {
      width: auto;
      height: auto;
      margin: 0;
      padding: 8px 16px;
      background: white;
      clip-path: none;
      clip: auto;
      overflow: visible;
      z-index: 150;
    }
  }
}

/* 
  APP Z-INDEXES:
  - staff trigger: 200
  - 150: skip link (even though it'll be inerted by js)
  - 100: sticky header (header below menu, above overlay)
  - 80: sticky search bar

  MODALS Z-INDEXES:
  - backdrop: 100
  - nav: 200
  - staff menu: 200
*/
